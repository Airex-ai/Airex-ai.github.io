<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Airex Yu">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2023/02/02/pytorch/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="PyTorchPyTorchçš„å®‰è£… ä¸‹è½½å¹¶å®‰è£…Anaconda æ‰“å¼€Anaconda Promptï¼Œæ–°å»ºPyTorchè™šæ‹Ÿç¯å¢ƒ     PyTorchç›¸å…³å‡½æ•°12dir()å‡½æ•°ï¼šæ‰“å¼€åŒ…çš„ç›®å½•ï¼Œæ˜¾ç¤ºç›®å½•åˆ†åŒºhelpï¼ˆï¼‰å‡½æ•°ï¼šåŒ…ä¸­çš„åˆ†åŒºçš„å·¥å…·çš„ä½¿ç”¨æ–¹æ³•     PyTorchåŠ è½½æ•°æ®Datasetï¼šæä¾›ä¸€ç§æ–¹å¼å»è·å–æ•°æ®åŠå…¶label  å¦‚ä½•è·å–æ¯ä¸€ä¸ªæ•°æ®åŠå…¶label è·å–æ•°æ®æ€»æ•°  Dataloa">
<meta property="og:type" content="article">
<meta property="og:title" content="PyTorch">
<meta property="og:url" content="http://example.com/2023/02/02/PyTorch/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="PyTorchPyTorchçš„å®‰è£… ä¸‹è½½å¹¶å®‰è£…Anaconda æ‰“å¼€Anaconda Promptï¼Œæ–°å»ºPyTorchè™šæ‹Ÿç¯å¢ƒ     PyTorchç›¸å…³å‡½æ•°12dir()å‡½æ•°ï¼šæ‰“å¼€åŒ…çš„ç›®å½•ï¼Œæ˜¾ç¤ºç›®å½•åˆ†åŒºhelpï¼ˆï¼‰å‡½æ•°ï¼šåŒ…ä¸­çš„åˆ†åŒºçš„å·¥å…·çš„ä½¿ç”¨æ–¹æ³•     PyTorchåŠ è½½æ•°æ®Datasetï¼šæä¾›ä¸€ç§æ–¹å¼å»è·å–æ•°æ®åŠå…¶label  å¦‚ä½•è·å–æ¯ä¸€ä¸ªæ•°æ®åŠå…¶label è·å–æ•°æ®æ€»æ•°  Dataloa">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202120702274.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202120838866.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202120914227.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202105634838.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202125029854.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202131516752.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202143017598.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202154015781.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202154713202.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202161942267-16753259824521.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202161953173.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202162156741.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202162535967.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202163711159.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230202164946144.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203161036473.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203162209976.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203165216808.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203165345341.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203170328819.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203173233888.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203173932274.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230203181054880.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204115128009.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204120829336.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204120959960.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204121416305.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204130304040.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204162901337.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204170716066.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204170810217.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204172323633.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204173052506.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204180918038.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204184039948.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230204185132536.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230205135509867.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230205153242191.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230205222100995.png">
<meta property="og:image" content="http://example.com/2023/02/02/PyTorch/image-20230205223516248.png">
<meta property="article:published_time" content="2023-02-02T04:32:18.000Z">
<meta property="article:modified_time" content="2023-05-25T13:11:31.692Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="PyTorch">
<meta property="article:tag" content="TensorBoard">
<meta property="article:tag" content="VGG">
<meta property="article:tag" content="æ¨¡å‹è®­ç»ƒ">
<meta property="article:tag" content="ä¼˜åŒ–å™¨">
<meta property="article:tag" content="æ¿€æ´»å‡½æ•°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/02/02/PyTorch/image-20230202120702274.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/%E9%B1%BC.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/%E9%B1%BC.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/%E9%B1%BC.svg">
    <!--- Page Info-->
    
    <title>
        
            PyTorch -
        
        Airex-Daily
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/assets/fonts.css">

    <!--- Font Part-->
    
    
    
        <link href="" rel="stylesheet">
    
    
        <link href="" rel="stylesheet">
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":false,"title":"æ¨èé˜…è¯»","limit":3,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":true,"family":null,"url":null},"english":{"enable":true,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fix","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-rry6gw.png"},"title":"ä¼¸æ‰‹ä¹Ÿæ¡ä¸ä½å½©è™¹ğŸŒˆ","subtitle":{"text":["â€”â€”æˆ‘æœŸå¾…"],"hitokoto":{"enable":true,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/Airex-ai","instagram":null,"zhihu":null,"twitter":null,"email":"airex.yu@foxmail.com"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":"https://music.163.com/song?id=1501530173&userid=253099352","cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.1.5","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user","submenus":{"Github":"https://github.com/Airex-ai?tab=repositories"}},"éšè®°":{"icon":"fa-solid fa-tree-palm","path":"/masonry/"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}}};
    Global.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
    Global.data_config = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Airex-Daily
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        é¦–é¡µ
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        å½’æ¡£
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        å…³äº&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/Airex-ai?tab=repositories">GITHUB
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/masonry/"  >
                                    
                                        
                                            <i class="fa-solid fa-tree-palm"></i>
                                        
                                        éšè®°
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                é¦–é¡µ
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                å½’æ¡£
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                å…³äº&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/Airex-ai?tab=repositories">GITHUB</a>
                            </li>
                        
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/masonry/"  >
                             
                                
                                    <i class="fa-solid fa-tree-palm"></i>
                                
                                éšè®°
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
             
                <div class="article-title">         
                    <img src="/images/Pytorch.jpg" alt="PyTorch" />
                    <h1 class="article-title-cover">PyTorch</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/%E5%A4%B4%E5%83%8F.JPG">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Airex Yu</span>
                            
                                <span class="author-label">Lv3</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-02-02 12:32:18</span>
        <span class="mobile">2023-02-02 12:32</span>
        <span class="hover-info">åˆ›å»º</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-05-25 21:11:31</span>
            <span class="mobile">2023-05-25 21:11</span>
            <span class="hover-info">æ›´æ–°</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/PyTorch/">PyTorch</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/TensorBoard/">TensorBoard</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/VGG/">VGG</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/">æ¨¡å‹è®­ç»ƒ</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E4%BC%98%E5%8C%96%E5%99%A8/">ä¼˜åŒ–å™¨</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/">æ¿€æ´»å‡½æ•°</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h1 id="PyTorch"><a href="#PyTorch" class="headerlink" title="PyTorch"></a><strong>PyTorch</strong></h1><h2 id="PyTorchçš„å®‰è£…"><a href="#PyTorchçš„å®‰è£…" class="headerlink" title="PyTorchçš„å®‰è£…"></a><strong>PyTorchçš„å®‰è£…</strong></h2><ol>
<li><strong>ä¸‹è½½å¹¶å®‰è£…Anaconda</strong></li>
<li><strong>æ‰“å¼€Anaconda Promptï¼Œæ–°å»ºPyTorchè™šæ‹Ÿç¯å¢ƒ</strong></li>
</ol>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202120702274.png"
                      class="" title="image-20230202120702274"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202120838866.png"
                      class="" title="image-20230202120838866"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202120914227.png"
                      class="" title="image-20230202120914227"
                ></strong></p>
<h2 id="PyTorchç›¸å…³å‡½æ•°"><a href="#PyTorchç›¸å…³å‡½æ•°" class="headerlink" title="PyTorchç›¸å…³å‡½æ•°"></a><strong>PyTorchç›¸å…³å‡½æ•°</strong></h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dir()å‡½æ•°ï¼šæ‰“å¼€åŒ…çš„ç›®å½•ï¼Œæ˜¾ç¤ºç›®å½•åˆ†åŒº</span><br><span class="line">helpï¼ˆï¼‰å‡½æ•°ï¼šåŒ…ä¸­çš„åˆ†åŒºçš„å·¥å…·çš„ä½¿ç”¨æ–¹æ³•</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202105634838.png"
                      class="" title="image-20230202105634838"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202125029854.png"
                      class="" title="image-20230202125029854"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202131516752.png"
                      class="" title="image-20230202131516752"
                ></strong></p>
<h1 id="PyTorchåŠ è½½æ•°æ®"><a href="#PyTorchåŠ è½½æ•°æ®" class="headerlink" title="PyTorchåŠ è½½æ•°æ®"></a><strong>PyTorchåŠ è½½æ•°æ®</strong></h1><p><strong>Datasetï¼šæä¾›ä¸€ç§æ–¹å¼å»è·å–æ•°æ®åŠå…¶label</strong></p>
<ul>
<li><strong>å¦‚ä½•è·å–æ¯ä¸€ä¸ªæ•°æ®åŠå…¶label</strong></li>
<li><strong>è·å–æ•°æ®æ€»æ•°</strong></li>
</ul>
<p><strong>Dataloaderï¼š</strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202143017598.png"
                      class="" title="image-20230202143017598"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyData</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,root_dir,label_dir</span>):   <span class="comment">#selfç›¸å½“äºåˆå§‹æ—¶çš„å¯¹è±¡ï¼Œroot_dirå’Œlabel_diréƒ½æ˜¯åˆå§‹æ—¶éœ€è¦ä¼ å…¥çš„å¯¹è±¡</span></span><br><span class="line">        self.root_dir = root_dir             <span class="comment">#æ–°å»ºäº†root_dirå’Œlabel_dirä¸¤ä¸ªå±€éƒ¨å˜é‡</span></span><br><span class="line">        self.label_dir = label_dir</span><br><span class="line">        <span class="comment">#å› ä¸ºæ“ä½œç³»ç»Ÿçš„ä¸åŒï¼Œè½¬ç§»å­—ç¬¦ / å¯èƒ½ä¼šå¯¼è‡´å­—ç¬¦è¿æ¥çš„é”™è¯¯ï¼Œos.path.join()å‡½æ•°å¯ä»¥é¿å…è¿™ç§é”™è¯¯å°†ä¸¤ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥</span></span><br><span class="line">        self.path = os.path.join(self.root_dir,self.label_dir)</span><br><span class="line">        self.img_path = os.listdir(self.path)       <span class="comment">#å°†ä¸€ä¸ªæ–‡ä»¶å¤¹è½¬æ¢æˆäº†åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        img_name = self.img_path[item]   <span class="comment">#itemæ˜¯åˆ—è¡¨åºå·ï¼Œè¿”å›çš„æ˜¯åˆ—è¡¨å¯¹åº”åºå·çš„æ–‡ä»¶åç§°</span></span><br><span class="line">        img_item_path = os.path.join(self.root_dir,self.label_dir,img_name)</span><br><span class="line">        img  = Image.<span class="built_in">open</span>(img_item_path)  <span class="comment">#æ‰“å¼€å¹¶æ ‡è¯†å›¾åƒ</span></span><br><span class="line">        label = self.label_dir</span><br><span class="line">        <span class="keyword">return</span> img,label        <span class="comment">#è¿”å›å›¾åƒå’Œå›¾åƒçš„æ ‡è¯†</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.img_path)</span><br><span class="line"></span><br><span class="line">root_dir = <span class="string">&quot;dataset/train&quot;</span></span><br><span class="line">ants_label_dir = <span class="string">&quot;ants&quot;</span></span><br><span class="line">bees_label_dir = <span class="string">&quot;bees&quot;</span></span><br><span class="line">ants_dataset = MyData(root_dir,ants_label_dir)</span><br><span class="line">bees_dataset = MyData(root_dir,bees_label_dir)</span><br><span class="line"></span><br><span class="line">train_dataset = ants_dataset + bees_dataset  <span class="comment">#å°†ä¸¤ä¸ªæ•°æ®é›†ç›¸åŠ </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202154015781.png"
                      class="" title="image-20230202154015781"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202154713202.png"
                      class="" title="image-20230202154713202"
                ></strong></p>
<h1 id="Tensorboard"><a href="#Tensorboard" class="headerlink" title="Tensorboard"></a><strong>Tensorboard</strong></h1><h2 id="ç»˜åˆ¶å›¾åƒ"><a href="#ç»˜åˆ¶å›¾åƒ" class="headerlink" title="ç»˜åˆ¶å›¾åƒ"></a><strong>ç»˜åˆ¶å›¾åƒ</strong></h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">write = SummaryWriter(<span class="string">&quot;logs&quot;</span>)   <span class="comment">#æ–‡ä»¶ä¿å­˜è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):   <span class="comment">#ç”»å›¾åƒ</span></span><br><span class="line">    <span class="comment">#write.add_scalar(&quot;y=x&quot;,i,i)   #ä¸€èˆ¬éœ€è¦3ä¸ªå‚æ•°ï¼Œæ•°æ®åå­—ï¼ˆæ ‡è¯†ï¼‰ï¼Œæ•°æ®å€¼(yè½´)ï¼Œè®­ç»ƒæ­¥é•¿(xè½´)ã€‚å‡½æ•°çš„ä½œç”¨å°±æ˜¯ç”»ä»€ä¹ˆæ ·çš„å›¾</span></span><br><span class="line">    write.add_scalar(<span class="string">&quot;y=2x&quot;</span>,<span class="number">2</span>*i,i)   <span class="comment">#ä¸€èˆ¬éœ€è¦3ä¸ªå‚æ•°ï¼Œæ•°æ®åå­—ï¼ˆæ ‡è¯†ï¼‰ï¼Œæ•°æ®å€¼(yè½´)ï¼Œè®­ç»ƒæ­¥é•¿(xè½´)ã€‚å‡½æ•°çš„ä½œç”¨å°±æ˜¯ç”»ä»€ä¹ˆæ ·çš„å›¾</span></span><br><span class="line"></span><br><span class="line">write.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202161942267-16753259824521.png"
                      class="" title="image-20230202161942267"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202161953173.png"
                      class="" title="image-20230202161953173"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202162156741.png"
                      class="" title="image-20230202162156741"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202162535967.png"
                      class="" title="image-20230202162535967"
                ></strong></p>
<h2 id="æ·»åŠ å›¾ç‰‡"><a href="#æ·»åŠ å›¾ç‰‡" class="headerlink" title="æ·»åŠ å›¾ç‰‡"></a><strong>æ·»åŠ å›¾ç‰‡</strong></h2><p><strong><code> write.add_image()</code>å‡½æ•°ä¸­æ”¯æŒçš„å›¾ç‰‡æœ‰torch.Tensor, numpy.array, or string&#x2F;blobname</strong> </p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202163711159.png"
                      class="" title="image-20230202163711159"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img_array = np.array(img)   <span class="comment">#è½¬åŒ–å›¾ç‰‡ç±»å‹ï¼Œæ³¨æ„imgå›¾ç‰‡ä¸€å®šå¾—æ˜¯å“¦é€šè¿‡Image.openæ‰“å¼€çš„</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">write = SummaryWriter(<span class="string">&quot;logs&quot;</span>)   <span class="comment">#æ–‡ä»¶ä¿å­˜è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">image_path = <span class="string">&quot;dataset/train/ants/0013035.jpg&quot;</span></span><br><span class="line">img_PIL = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">img_array = np.array(img_PIL)     <span class="comment">#è½¬æ¢å›¾ç‰‡ç±»å‹</span></span><br><span class="line"><span class="built_in">print</span>(img_array.shape)</span><br><span class="line">write.add_image(<span class="string">&quot;test&quot;</span>,img_array,dataformats=<span class="string">&#x27;HWC&#x27;</span>)         <span class="comment">#ç”»å›¾,æ³¨æ„ï¼šä»PILåˆ°numpyï¼Œéœ€è¦åœ¨add_image()ä¸­æŒ‡å®šshapeçš„å«ä¹‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">write.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230202164946144.png"
                      class="" title="image-20230202164946144"
                ></strong></p>
<h1 id="transforms"><a href="#transforms" class="headerlink" title="transforms"></a><strong>transforms</strong></h1><h2 id="å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹"><a href="#å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹" class="headerlink" title="å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹"></a><strong>å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹</strong></h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1ã€ä½¿ç”¨transforms</span></span><br><span class="line">img_path = <span class="string">&quot;dataset/train/ants/0013035.jpg&quot;</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(img_path)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–transformså¯¹è±¡</span></span><br><span class="line">tensor_trans = transforms.ToTensor()</span><br><span class="line"><span class="comment">#å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹</span></span><br><span class="line">tensor_img = tensor_trans(img)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(tensor_img)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203161036473.png"
                      class="" title="image-20230203161036473"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"><span class="comment"># 1ã€ä½¿ç”¨transforms</span></span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">img_path = <span class="string">&quot;dataset/train/ants/0013035.jpg&quot;</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(img_path)</span><br><span class="line">tensor_trans = transforms.ToTensor()</span><br><span class="line">img_tensor = tensor_trans(img)</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line"><span class="comment">#ä¼ å…¥çš„img_tensorçš„ç±»å‹å°±æ˜¯tensor</span></span><br><span class="line">img = writer.add_image(<span class="string">&quot;test&quot;</span>,img_tensor)   <span class="comment">#å‚æ•°åˆ†åˆ«æ˜¯æ ‡è¯†ï¼Œå›¾ç‰‡ç±»å‹ï¼ˆtorch.Tensor, numpy.array, or string/blobnameï¼‰ç­‰å‚æ•°</span></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203162209976.png"
                      class="" title="image-20230203162209976"
                ></strong></p>
<h2 id="å¸¸è§çš„transforms"><a href="#å¸¸è§çš„transforms" class="headerlink" title="å¸¸è§çš„transforms"></a><strong>å¸¸è§çš„transforms</strong></h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__call__(avg1ï¼Œavg2)å‡½æ•°ï¼šè°ƒç”¨è¯¥å‡½æ•°æ—¶ä¸éœ€è¦ä½¿ç”¨ . çš„æ–¹å¼è°ƒç”¨</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Persion</span>ï¼š</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self,name</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;__call__&quot;</span>+<span class="string">&quot; hello &quot;</span>+name)</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">self,name</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;hello&quot;</span>+name)</span><br><span class="line">		</span><br><span class="line">person = Person()</span><br><span class="line">person(<span class="string">&quot;zhangsan&quot;</span>)        <span class="comment">#è°ƒç”¨__call__å‡½æ•°</span></span><br><span class="line">person.hello(<span class="string">&quot;lisi&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="å½’ä¸€åŒ–"><a href="#å½’ä¸€åŒ–" class="headerlink" title="å½’ä¸€åŒ–"></a><strong>å½’ä¸€åŒ–</strong></h3><p>  <strong>å½’ä¸€åŒ–ï¼šå½’ä¸€åŒ–å°±æ˜¯è¦æŠŠéœ€è¦å¤„ç†çš„æ•°æ®ç»è¿‡å¤„ç†åï¼ˆå‡å€¼å˜ä¸º0ï¼Œæ ‡å‡†å·®å˜ä¸º1ï¼‰é™åˆ¶åœ¨ä½ éœ€è¦çš„ä¸€å®šèŒƒå›´å†…ï¼Œä¸ºäº†åé¢æ•°æ®å¤„ç†çš„æ–¹ä¾¿ï¼Œä¿è¯ç¨‹åºè¿è¡Œæ—¶æ”¶æ•›åŠ å¿«ã€‚</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Normalize</span></span><br><span class="line"><span class="built_in">print</span>(img_tensor[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]) <span class="comment">#ç¬¬0å±‚ç¬¬0è¡Œç¬¬0åˆ—çš„åƒç´ </span></span><br><span class="line">trans_norm = transforms.Normalize([<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>],[<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">0.5</span>])  <span class="comment">#meanï¼šå„é€šé“çš„å‡å€¼ stdï¼šå„é€šé“çš„æ ‡å‡†å·® inplaceï¼šæ˜¯å¦åŸåœ°æ“ä½œ</span></span><br><span class="line">img_norm = trans_norm(img_tensor)</span><br><span class="line"><span class="built_in">print</span>(img_norm[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>])</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203165216808.png"
                      class="" title="image-20230203165216808"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203165345341.png"
                      class="" title="image-20230203165345341"
                ></strong></p>
<h3 id="Resize"><a href="#Resize" class="headerlink" title="Resize"></a><strong>Resize</strong></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(img.size)</span><br><span class="line">trans_size = transforms.Resize((<span class="number">512</span>,<span class="number">512</span>))</span><br><span class="line">img_resize = trans_size(img)</span><br><span class="line">img_resize = tensor_trans(img_resize)</span><br><span class="line">writer.add_image(<span class="string">&quot;Resize&quot;</span>,img_resize,<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(img_resize)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203170328819.png"
                      class="" title="image-20230203170328819"
                ></strong></p>
<h3 id="compose"><a href="#compose" class="headerlink" title="compose"></a><strong>compose</strong></h3><p><strong>composeå‡½æ•°å¯ä»¥ç†è§£ä¸ºä¸€æ¬¡æ€§åœ°å°†ä¸€å¼ å›¾ç‰‡è¿›è¡Œäº†ä¸¤æ¬¡å˜åŒ–</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compose - resize - 2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Compose()çš„å‚æ•°éœ€è¦æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå³[æ•°æ®1ï¼Œæ•°æ®2ï¼Œ...]</span></span><br><span class="line"><span class="string">    åˆComposeä¸­çš„å‚æ•°éœ€è¦æ—¶transformsç±»å‹ï¼Œæ‰€ä»¥Compose([transforms1,transforms2,....])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">trans_resize_2 = transforms.Resize(<span class="number">512</span>)</span><br><span class="line"><span class="comment">#PIL -&gt; PIL -&gt; tensor</span></span><br><span class="line">trans_compose = transforms.Compose([trans_resize_2,tensor_trans])  <span class="comment">#Compose()å‡½æ•°çš„å‚æ•°ä¸­ï¼Œavg2çš„è¾“å…¥å¿…é¡»ä¸ºavg1çš„è¾“å‡º</span></span><br><span class="line">img_resize_2 = trans_compose(img)</span><br><span class="line">writer.add_image(<span class="string">&quot;Resize2&quot;</span>,img_resize_2,<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203173233888.png"
                      class="" title="image-20230203173233888"
                ></strong></p>
<h3 id="RandomCrop"><a href="#RandomCrop" class="headerlink" title="RandomCrop"></a><strong>RandomCrop</strong></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Randomcrop</span></span><br><span class="line">trans_random = transforms.RandomCrop(<span class="number">512</span>)</span><br><span class="line">trans_compose_2 = transforms.Compose([trans_random,tensor_trans])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment">#éšæœºè£å‰ªäº†åå¼ </span></span><br><span class="line">    img_crop = trans_compose_2(img)</span><br><span class="line">    writer.add_image(<span class="string">&quot;RandomCrop&quot;</span>,img_crop,i)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203173932274.png"
                      class="" title="image-20230203173932274"
                ></strong></p>
<h1 id="Torchvisionä¸­æ•°æ®é›†çš„ä½¿ç”¨"><a href="#Torchvisionä¸­æ•°æ®é›†çš„ä½¿ç”¨" class="headerlink" title="Torchvisionä¸­æ•°æ®é›†çš„ä½¿ç”¨"></a><strong>Torchvisionä¸­æ•°æ®é›†çš„ä½¿ç”¨</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”¨torchvisionä»ç½‘ç»œä¸­ä¸‹è½½æ•°æ®é›†</span></span><br><span class="line">train_set = torchvision.datasets.CIFAR10(root=<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">True</span>,download=<span class="literal">True</span>)  <span class="comment">#./ä»£è¡¨å½“å‰ç›®å½•</span></span><br><span class="line">test_set = torchvision.datasets.CIFAR10(root=<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(test_set[<span class="number">0</span>]) <span class="comment">#æ•°æ®é›†ä¸­çš„ç¬¬ä¸€ä¸ªæ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(test_set.classes) <span class="comment">#æ•°æ®é›†çš„æ•°æ®ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å¾—å¯¹è±¡</span></span><br><span class="line">img,target = test_set[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(img)</span><br><span class="line"><span class="built_in">print</span>(target)                     <span class="comment">#å¯ä»¥ç†è§£ä¸ºå›¾ç‰‡çš„æ ‡è¯†ï¼Œæ•°æ®é›†ç¬¬ä¸€ä¸ªå¯¹è±¡çš„æ ‡è¯†æ˜¯æ ‡è¯†åˆ—è¡¨çš„ç¬¬ä¸‰ä¸ª</span></span><br><span class="line"><span class="built_in">print</span>(test_set.classes[target])   <span class="comment">#æ‰“å°æ•°æ®é›†ç¬¬ä¸€ä¸ªå¯¹è±¡çš„æ ‡è¯†</span></span><br><span class="line"><span class="comment"># img.show()</span></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230203181054880.png"
                      class="" title="image-20230203181054880"
                ></strong></p>
<h1 id="DataLoaderçš„ä½¿ç”¨"><a href="#DataLoaderçš„ä½¿ç”¨" class="headerlink" title="DataLoaderçš„ä½¿ç”¨"></a><strong>DataLoaderçš„ä½¿ç”¨</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line">test_data = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line"><span class="comment">#batch_sizeï¼šæ¯æ¬¡å–æ•°æ®çš„ä¸ªæ•° shuffleï¼šé‡å¤å–æ•°æ®é›†æ—¶ï¼Œé¡ºåºæ˜¯å¦å˜åŒ–    num_workersï¼šå¤šçº¿ç¨‹    drop_lastï¼šå—å¦å–ä½™</span></span><br><span class="line">test_loader = DataLoader(dataset=test_data,batch_size=<span class="number">4</span>,shuffle=<span class="literal">True</span>,num_workers=<span class="number">0</span>,drop_last=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•æ•°æ®é›†ä¸­ç¬¬ä¸€å¼ å›¾ç‰‡åŠtarget</span></span><br><span class="line">img,target = test_data[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(img.shape)</span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span>  test_loader:    </span><br><span class="line">    imgs,targets = data</span><br><span class="line">    <span class="built_in">print</span>(imgs.shape)</span><br><span class="line">    <span class="built_in">print</span>(targets)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204115128009.png"
                      class="" title="image-20230204115128009"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">test_data = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line"><span class="comment">#batch_sizeï¼šæ¯æ¬¡å–æ•°æ®çš„ä¸ªæ•° shuffleï¼šé‡å¤å–æ•°æ®é›†æ—¶ï¼Œé¡ºåºæ˜¯å¦å˜åŒ–    num_workersï¼šå¤šçº¿ç¨‹    drop_lastï¼šæ•°æ®ä¸ªæ•°ä¸è¶³batch_sizeæ˜¯å¦èˆå»</span></span><br><span class="line">test_loader = DataLoader(dataset=test_data,batch_size=<span class="number">64</span>,shuffle=<span class="literal">True</span>,num_workers=<span class="number">0</span>,drop_last=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•æ•°æ®é›†ä¸­ç¬¬ä¸€å¼ å›¾ç‰‡åŠtarget</span></span><br><span class="line">img,target = test_data[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(img.shape)</span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;data_loader&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    step = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span>  test_loader:</span><br><span class="line">        imgs,targets = data</span><br><span class="line">        <span class="comment"># print(imgs.shape)</span></span><br><span class="line">        <span class="comment"># print(targets)</span></span><br><span class="line">        writer.add_images(<span class="string">&quot;Epoch&#123;&#125;&quot;</span>.<span class="built_in">format</span>(epoch),imgs,step)</span><br><span class="line">        step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204120829336.png"
                      class="" title="image-20230204120829336"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204120959960.png"
                      class="" title="image-20230204120959960"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204121416305.png"
                      class="" title="image-20230204121416305"
                ></strong></p>
<h1 id="ç¥ç»ç½‘ç»œéª¨æ¶"><a href="#ç¥ç»ç½‘ç»œéª¨æ¶" class="headerlink" title="ç¥ç»ç½‘ç»œéª¨æ¶"></a><strong>ç¥ç»ç½‘ç»œéª¨æ¶</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">testModule</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output = <span class="built_in">input</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">test_module = testModule()</span><br><span class="line">x = torch.tensor(<span class="number">1.0</span>)       <span class="comment">#å°†1è½¬ä¸ºtensorç±»å‹</span></span><br><span class="line">output = test_module(x)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure></div>

<h1 id="å·ç§¯æµ‹è¯•"><a href="#å·ç§¯æµ‹è¯•" class="headerlink" title="å·ç§¯æµ‹è¯•"></a><strong>å·ç§¯æµ‹è¯•</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.tensor([           <span class="comment">#shapeæ˜¯[5,5]</span></span><br><span class="line">    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">kernel = torch.tensor([</span><br><span class="line">    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#reshape tensor</span></span><br><span class="line"><span class="built_in">input</span> = torch.reshape(<span class="built_in">input</span>,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>))</span><br><span class="line">kernel = torch.reshape(kernel,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>.shape)</span><br><span class="line"><span class="built_in">print</span>(kernel.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å·ç§¯</span></span><br><span class="line">output = F.conv2d(<span class="built_in">input</span>,kernel,stride=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204130304040.png"
                      class="" title="image-20230204130304040"
                ></strong></p>
<h1 id="å·ç§¯å±‚"><a href="#å·ç§¯å±‚" class="headerlink" title="å·ç§¯å±‚"></a><strong>å·ç§¯å±‚</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line"></span><br><span class="line">data_loader = DataLoader(dataset,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">convolution2</span>(nn.Module):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:               <span class="comment">#å¯¹è±¡å®ä¾‹åŒ–ä¼šè‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = Conv2d(<span class="number">3</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>)  <span class="comment"># è¾“å…¥é€šé“æ•°ï¼šin_channelsï¼Œå›¾ç‰‡è¾“å…¥å°±æ˜¯ä¸‰é€šé“ï¼›kernel_sizeï¼šè¿‡æ»¤å™¨çš„ç»´æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):              <span class="comment">#æ¥å—å‚æ•°è¾“å…¥</span></span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">conv2 = convolution2()</span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line"></span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> data_loader:</span><br><span class="line">    imgs,target = data</span><br><span class="line">    output = conv2(imgs)</span><br><span class="line">    <span class="comment">#è¾“å…¥ torch.Size([64, 3, 32, 32])</span></span><br><span class="line">    <span class="built_in">print</span>(imgs.shape)</span><br><span class="line">    writer.add_images(<span class="string">&quot;convolution_before&quot;</span>,imgs,step)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#è¾“å‡º torch.Size([64, 6, 30, 30])</span></span><br><span class="line">    <span class="built_in">print</span>(output.shape)</span><br><span class="line">    output = torch.reshape(output,(-<span class="number">1</span>,<span class="number">3</span>,<span class="number">30</span>,<span class="number">30</span>))                  <span class="comment">#-1è¡¨ç¤ºé€šè¿‡åé¢çš„æ•°å­—è‡ªé€‚åº”size</span></span><br><span class="line">    writer.add_images(<span class="string">&quot;convolution_after&quot;</span>,output,step)         <span class="comment">#tensorboardåªèƒ½æ˜¾ç¤º3ä¸ªé€šé“çš„å›¾åƒï¼Œç»è¿‡å·ç§¯åçš„å›¾åƒå˜ä¸ºäº†6é€šé“ï¼Œæ‰€ä»¥è¦reshape</span></span><br><span class="line"></span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204162901337.png"
                      class="" title="image-20230204162901337"
                ></strong></p>
<h1 id="æ± åŒ–å±‚"><a href="#æ± åŒ–å±‚" class="headerlink" title="æ± åŒ–å±‚"></a><strong>æ± åŒ–å±‚</strong></h1><p><strong>ç±»æ¯”äºè§†é¢‘çš„åˆ†è¾¨ç‡ï¼Œ1080pçš„è§†é¢‘ç»è¿‡æ± åŒ–åå¯ä»¥å˜æˆ4kæˆ–å…¶ä»–åˆ†è¾¨ç‡ã€‚æ± åŒ–å±‚çš„ä½œç”¨å°±æ˜¯æœ€å¤§ç¨‹åº¦åœ°ä¿æŒå†…å®¹çš„ç›¸ä¼¼ï¼Œæ•°æ®å¤§å°å°½å¯èƒ½å°</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> MaxPool2d</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,<span class="literal">False</span>,torchvision.transforms.ToTensor())</span><br><span class="line">dataLoader = DataLoader(dataset,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">maxPool</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.maxpol1 = MaxPool2d(kernel_size=<span class="number">3</span>,ceil_mode=<span class="literal">False</span>)   <span class="comment">#dilationï¼ˆæ‰©å¼ ï¼‰ï¼šè¡¨ç¤ºæ¯ä¸ªçŸ©é˜µç›¸é‚»å…ƒç´ çš„é—´éš”    ceil_modeï¼šæ•°å­—å‘ä¸Šå–æ•´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output = self.maxpol1(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">maxpool_test = maxPool()</span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs,target = data</span><br><span class="line">    writer.add_images(<span class="string">&quot;input&quot;</span>,imgs,step)</span><br><span class="line">    output = maxpool_test(imgs)</span><br><span class="line">    writer.add_images(<span class="string">&quot;output&quot;</span>,output,step)</span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204170716066.png"
                      class="" title="image-20230204170716066"
                ></strong></p>
<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204170810217.png"
                      class="" title="image-20230204170810217"
                ></strong></p>
<h1 id="éçº¿æ€§æ¿€æ´»"><a href="#éçº¿æ€§æ¿€æ´»" class="headerlink" title="éçº¿æ€§æ¿€æ´»"></a><strong>éçº¿æ€§æ¿€æ´»</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> ReLU</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.tensor([</span><br><span class="line">    [<span class="number">1</span>,-<span class="number">0.5</span>],</span><br><span class="line">    [-<span class="number">1</span>,<span class="number">3</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">nonLinear_act</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.reLu1 = ReLU()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output = self.reLu1(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">nonL = nonLinear_act()</span><br><span class="line">output = nonL(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204172323633.png"
                      class="" title="image-20230204172323633"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> ReLU, Sigmoid</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line">dataLoader = DataLoader(dataset,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">nonLinear_act</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.sigmoid = Sigmoid()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output = self.sigmoid(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">nonL = nonLinear_act()</span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">step = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs,target = data</span><br><span class="line">    output = nonL(imgs)</span><br><span class="line">    writer.add_images(<span class="string">&quot;sigMoidâ€”â€”befor&quot;</span>, imgs, step)</span><br><span class="line">    writer.add_images(<span class="string">&quot;sigMoid&quot;</span>,output,step)</span><br><span class="line">    step = step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204173052506.png"
                      class="" title="image-20230204173052506"
                ></strong></p>
<h1 id="çº¿æ€§æ¿€æ´»"><a href="#çº¿æ€§æ¿€æ´»" class="headerlink" title="çº¿æ€§æ¿€æ´»"></a><strong>çº¿æ€§æ¿€æ´»</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> ReLU, Sigmoid, Linear</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line">dataLoader = DataLoader(dataset,<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Linear_act</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.linear = Linear(<span class="number">196608</span>,<span class="number">10</span>)  <span class="comment">#in_featureï¼š size of each input sample</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,<span class="built_in">input</span></span>):</span><br><span class="line">        output = self.linear(<span class="built_in">input</span>)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">linear_test = Linear_act()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs,target = data</span><br><span class="line">    <span class="built_in">print</span>(imgs.shape)</span><br><span class="line">    output = torch.flatten(imgs)      <span class="comment">#å°†ä¸€å¼ å›¾ç‰‡é“ºå¹³</span></span><br><span class="line">    <span class="built_in">print</span>(output.shape)</span><br><span class="line">    output = linear_test(output)</span><br><span class="line">    <span class="built_in">print</span>(output.shape)              <span class="comment">#çº¿æ€§å˜æ¢åçš„å›¾ç‰‡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204180918038.png"
                      class="" title="image-20230204180918038"
                ></strong></p>
<h1 id="Sequentialçš„ä½¿ç”¨"><a href="#Sequentialçš„ä½¿ç”¨" class="headerlink" title="Sequentialçš„ä½¿ç”¨"></a><strong>Sequentialçš„ä½¿ç”¨</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Flatten, Linear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CiFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = Conv2d(<span class="number">3</span>,<span class="number">32</span>,<span class="number">5</span>,padding=<span class="number">2</span>)</span><br><span class="line">        self.maxPool1 = MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.conv2 = Conv2d(<span class="number">32</span>,<span class="number">32</span>,<span class="number">5</span>,padding=<span class="number">2</span>)</span><br><span class="line">        self.maxPool2 = MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.conv3 = Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>)</span><br><span class="line">        self.maxPool3 = MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.flatten = Flatten()  <span class="comment">#å°†æ•°æ®å˜æ¢æˆä¸€ç»´</span></span><br><span class="line">        self.linear1 = Linear(<span class="number">1024</span>,<span class="number">64</span>)</span><br><span class="line">        self.linear2 = Linear(<span class="number">64</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        x = self.maxPool1(x)</span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = self.maxPool2(x)</span><br><span class="line">        x = self.conv3(x)</span><br><span class="line">        x = self.maxPool3(x)</span><br><span class="line">        x = self.flatten(x)</span><br><span class="line">        x = self.linear1(x)</span><br><span class="line">        x = self.linear2(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">ciFar = CiFar()</span><br><span class="line"><span class="comment"># print(ciFar)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.ones((<span class="number">64</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">32</span>))    <span class="comment">#64ä¸ª3é€šé“çš„32*32çš„tensorå‹æ•°æ®</span></span><br><span class="line">output = ciFar(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output.shape)            <span class="comment">#å°†64ä¸ª3é€šé“çš„32*32çš„tensorå‹æ•°æ®å˜ä¸º64ä¸ªåˆ—è¡¨ï¼ˆæ¯ä¸ªåˆ—è¡¨ä¸­æœ‰10ä¸ªæ•°ï¼‰</span></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204184039948.png"
                      class="" title="image-20230204184039948"
                ></strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Flatten, Linear, Sequential</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CiFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.model1 = Sequential(             <span class="comment">#Sequentialå°†æ‰€æœ‰çš„å±‚éƒ½è¿æ¥äº†èµ·æ¥</span></span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">ciFar = CiFar()</span><br><span class="line"><span class="comment"># print(ciFar)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span> = torch.ones((<span class="number">64</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">32</span>))    <span class="comment">#64ä¸ª3é€šé“çš„32*32çš„tensorå‹æ•°æ®</span></span><br><span class="line">output = ciFar(<span class="built_in">input</span>)</span><br><span class="line"><span class="built_in">print</span>(output.shape)            <span class="comment">#å°†64ä¸ª3é€šé“çš„32*32çš„tensorå‹æ•°æ®å˜ä¸º64ä¸ªåˆ—è¡¨ï¼ˆæ¯ä¸ªåˆ—è¡¨ä¸­æœ‰10ä¸ªæ•°ï¼‰</span></span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;logs&quot;</span>)</span><br><span class="line">writer.add_graph(ciFar,<span class="built_in">input</span>)         <span class="comment">#æ¨¡å‹ï¼›è¾“å…¥çš„æ•°æ®</span></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230204185132536.png"
                      class="" title="image-20230204185132536"
                ></strong></p>
<h1 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a><strong>æŸå¤±å‡½æ•°</strong></h1><p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li><strong>è®¡ç®—å®é™…è¾“å‡ºå’Œç›®æ ‡ä¹‹é—´çš„å·®è·</strong></li>
<li><strong>åå‘ä¼ æ’­ï¼Œå³é€šè¿‡æŸå¤±å‡½æ•°è¿›è¡Œæ¢¯åº¦ä¸‹é™</strong></li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> L1Loss, MSELoss, CrossEntropyLoss</span><br><span class="line"></span><br><span class="line">inputs = torch.tensor([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],dtype=torch.float32)</span><br><span class="line">targets = torch.tensor([<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>],dtype=torch.float32)</span><br><span class="line"></span><br><span class="line">inputs = torch.reshape(inputs,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>))          <span class="comment">#batch_size: 1;1é€šé“ï¼›1è¡Œ3åˆ—</span></span><br><span class="line"></span><br><span class="line">targets = torch.reshape(targets,(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">loss = L1Loss()</span><br><span class="line">result = loss(inputs,targets)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¹³æ–¹å·®</span></span><br><span class="line">loss_mse = MSELoss()</span><br><span class="line">result_mse = loss_mse(inputs,targets)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(result_mse)</span><br><span class="line"></span><br><span class="line"><span class="comment">#äº¤å‰ç†µæŸå¤±å‡½æ•°</span></span><br><span class="line">x = torch.tensor([<span class="number">0.1</span>,<span class="number">0.2</span>,<span class="number">0.3</span>])</span><br><span class="line">y = torch.tensor([<span class="number">1</span>])</span><br><span class="line">x = torch.reshape(x,(<span class="number">1</span>,<span class="number">3</span>))               <span class="comment">#1ä»£è¡¨1ä¸ª   3ä»£è¡¨3é€šé“</span></span><br><span class="line">loss_cross = CrossEntropyLoss()          <span class="comment">#è¾“å…¥è¾“å‡ºéƒ½æ˜¯tensorï¼Œè€Œtensoréƒ½æ˜¯3é€šé“çš„</span></span><br><span class="line">result_cross = loss_cross(x,y)</span><br><span class="line"><span class="built_in">print</span>(result_cross)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Flatten, Linear, Sequential, CrossEntropyLoss</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line">dataLoader = DataLoader(dataset,batch_size=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CiFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.model1 = Sequential(             <span class="comment">#Sequentialå°†æ‰€æœ‰çš„å±‚éƒ½è¿æ¥äº†èµ·æ¥</span></span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">ciFar = CiFar()</span><br><span class="line"></span><br><span class="line"><span class="comment">#äº¤å‰ç†µæŸå¤±å‡½æ•°é€‚ç”¨äºå¤šå…ƒåˆ†ç±»é—®é¢˜ï¼ŒCiFar10å°±æ˜¯åˆ†ç±»é—®é¢˜</span></span><br><span class="line">loss = CrossEntropyLoss()</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">    imgs,targets = data</span><br><span class="line">    outputs = ciFar(imgs)</span><br><span class="line">    result_loss = loss(outputs,targets)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#åå‘ä¼ æ’­      é€šè¿‡åå‘ä¼ æ’­æ¥æ‰§è¡Œæ¢¯åº¦ä¸‹é™ï¼›        æ³¨æ„åå‘ä¼ æ’­è¿ç”¨åœ¨ç»è¿‡æŸå¤±å‡½æ•°è®¡ç®—çš„ç»“æœ</span></span><br><span class="line">    result_loss.backward()</span><br><span class="line">    <span class="comment">#print(result_loss)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h1 id="ä¼˜åŒ–å™¨"><a href="#ä¼˜åŒ–å™¨" class="headerlink" title="ä¼˜åŒ–å™¨"></a><strong>ä¼˜åŒ–å™¨</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d, MaxPool2d, Flatten, Linear, Sequential, CrossEntropyLoss</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line">dataset = torchvision.datasets.CIFAR10(<span class="string">&quot;./dataset&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line">dataLoader = DataLoader(dataset,batch_size=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CiFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        self.model1 = Sequential(             <span class="comment">#Sequentialå°†æ‰€æœ‰çš„å±‚éƒ½è¿æ¥äº†èµ·æ¥</span></span><br><span class="line">            Conv2d(<span class="number">3</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">32</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, padding=<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">1024</span>, <span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">ciFar = CiFar()</span><br><span class="line"><span class="comment">#äº¤å‰ç†µæŸå¤±å‡½æ•°é€‚ç”¨äºå¤šå…ƒåˆ†ç±»é—®é¢˜ï¼ŒCiFar10å°±æ˜¯åˆ†ç±»é—®é¢˜</span></span><br><span class="line">loss = CrossEntropyLoss()</span><br><span class="line"><span class="comment">#æ¨¡å‹çš„å‚æ•°ï¼›å­¦ä¹ é€Ÿç‡</span></span><br><span class="line">optim = torch.optim.SGD(ciFar.parameters(),lr=<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    running_loss = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> dataLoader:</span><br><span class="line">        imgs,targets = data</span><br><span class="line">        outputs = ciFar(imgs)</span><br><span class="line">        result_loss = loss(outputs,targets)</span><br><span class="line">        optim.zero_grad()                        <span class="comment">#å°†ç½‘ç»œä¸­æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦ç½®0</span></span><br><span class="line">        result_loss.backward()                   <span class="comment">#åå‘ä¼ æ’­ï¼Œè·å¾—æ‰€æœ‰èŠ‚ç‚¹çš„æ¢¯åº¦</span></span><br><span class="line">        optim.step()                             <span class="comment">#æ¢¯åº¦ä¸‹é™</span></span><br><span class="line">        running_loss = running_loss + result_loss</span><br><span class="line">    <span class="built_in">print</span>(running_loss)          <span class="comment">#æ¯ä¸€è½®çš„æ€»æŸå¤±</span></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230205135509867.png"
                      class="" title="image-20230205135509867"
                ></strong></p>
<h1 id="VGG"><a href="#VGG" class="headerlink" title="VGG"></a><strong>VGG</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Linear</span><br><span class="line"></span><br><span class="line">vgg_false = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)  <span class="comment">#ä½¿ç”¨çš„æ˜¯åŸç½‘ç»œçš„å‚æ•°</span></span><br><span class="line">vgg_true = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(vgg_true)</span><br><span class="line"></span><br><span class="line">train_data = torchvision.datasets.CIFAR10(<span class="string">&#x27;./dataset&#x27;</span>,train=<span class="literal">True</span>,transform=torchvision.transforms.ToTensor())</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ›´æ”¹VGGæ¨¡å‹çš„è¾“å‡º</span></span><br><span class="line"><span class="comment"># vgg_true.classifier.add_module(&#x27;add_linear&#x27;,Linear(1000,10))   #vggæ¨¡å‹çš„æœ€åä¸€å±‚æœ‰4096ä¸ªè¾“å…¥ï¼Œ1000ä¸ªè¾“å‡ºï¼Œé€šè¿‡add_modeleåœ¨è¡¨æ ‡è¯†ä¸ºSequentialçš„å±‚æ·»åŠ äº†å¦å¤–ä¸€ä¸ªè¾“å…¥1000ï¼Œè¾“å‡º10çš„å±‚</span></span><br><span class="line"><span class="comment"># print(vgg_true)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡ä¿®æ”¹VGGæ¨¡å‹ç°æœ‰çš„å±‚æ”¹å˜æ¨¡å‹çš„è¾“å‡º</span></span><br><span class="line">vgg_false.classifier[<span class="number">6</span>] = Linear(<span class="number">4096</span>,<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(vgg_false)</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230205153242191.png"
                      class="" title="image-20230205153242191"
                ></strong></p>
<h1 id="æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½"><a href="#æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½" class="headerlink" title="æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½"></a><strong>æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½</strong></h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Conv2d</span><br><span class="line"></span><br><span class="line">vgg16 = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿å­˜æ–¹å¼1ï¼šè¦ä¿å­˜çš„ç½‘ç»œï¼›ä¿å­˜ç½‘ç»œçš„æ–‡ä»¶è·¯å¾„    .pthæ˜¯åç¼€å       (æ¨¡å‹ç»“æ„+æ¨¡å‹å‚æ•°)</span></span><br><span class="line">torch.save(vgg16,<span class="string">&quot;vgg16_method1.pth&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¿å­˜æ–¹å¼2ï¼šæ¨¡å‹å‚æ•°ï¼ˆå®˜æ–¹æ¨èï¼‰</span></span><br><span class="line">torch.save(vgg16.state_dict(),<span class="string">&quot;vgg16_method2.pth&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">model_test</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = Conv2d(<span class="number">3</span>,<span class="number">64</span>,kernel_size=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">model = model_test()</span><br><span class="line">torch.save(model,<span class="string">&quot;model_test.pth&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> model_save <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ–¹æ³•1åŠ è½½æ¨¡å‹ï¼Œå¯¹åº”ä¿å­˜æ–¹å¼1</span></span><br><span class="line">model = torch.load(<span class="string">&quot;vgg16_method1.pth&quot;</span>)</span><br><span class="line"><span class="comment"># print(model)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ–¹æ³•2åŠ è½½æ¨¡å‹ï¼Œå¯¹åº”ä¿å­˜æ–¹å¼2         æ¨¡å‹çš„å‚æ•°ä»¥å­—å…¸çš„å½¢å¼ä¿å­˜</span></span><br><span class="line">vgg16 = torchvision.models.vgg16(pretrained=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#torch.load(&quot;vgg16_method1.pth&quot;) å¯¹åº”çš„æ˜¯ä¿å­˜æ–¹å¼2ï¼›vgg16.load_state_dictåŠ è½½å­—å…¸ä¸­çš„å‚æ•°</span></span><br><span class="line">vgg16.load_state_dict(torch.load(<span class="string">&quot;vgg16_method2.pth&quot;</span>))       <span class="comment">#æ¨¡å‹åŠ è½½å‚æ•°</span></span><br><span class="line"><span class="comment"># print(vgg16)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³¨æ„ï¼Œåœ¨åŠ è½½æ¨¡å‹æ—¶éœ€è¦å£°æ˜æ¨¡å‹ï¼Œä½†ä¸éœ€è¦å®ä¾‹åŒ–æ¨¡å‹       å¯ä»¥ç”¨from model_save import *  ä»£æ›¿ä»¥ä¸‹ä»£ç </span></span><br><span class="line"><span class="comment"># class model_test(nn.Module):</span></span><br><span class="line"><span class="comment">#     def __init__(self) -&gt; None:</span></span><br><span class="line"><span class="comment">#         super().__init__()</span></span><br><span class="line"><span class="comment">#         self.conv1 = Conv2d(3,64,kernel_size=3)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     def forward(self,x):</span></span><br><span class="line"><span class="comment">#         x = self.conv1(x)</span></span><br><span class="line"><span class="comment">#         return x</span></span><br><span class="line"></span><br><span class="line">mdoel_1 = torch.load(<span class="string">&quot;model_test.pth&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(mdoel_1)</span><br></pre></td></tr></table></figure></div>

<h1 id="å®Œæ•´çš„è®­ç»ƒæ¨¡å‹å¥—è·¯"><a href="#å®Œæ•´çš„è®­ç»ƒæ¨¡å‹å¥—è·¯" class="headerlink" title="å®Œæ•´çš„è®­ç»ƒæ¨¡å‹å¥—è·¯"></a><strong>å®Œæ•´çš„è®­ç»ƒæ¨¡å‹å¥—è·¯</strong></h1><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a><strong>è¡¥å……</strong></h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">outputs = torch.tensor([</span><br><span class="line">    [<span class="number">0.1</span>,<span class="number">0.2</span>],</span><br><span class="line">    [<span class="number">0.3</span>,<span class="number">0.4</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¯”è¾ƒoutputsï¼Œè¾“å‡ºæ•°å€¼æœ€å¤§çš„åºå·  1æ¨ªå‘ 0çºµå‘</span></span><br><span class="line"><span class="built_in">print</span>(outputs.argmax(<span class="number">1</span>))      <span class="comment">#è¾“å‡ºtensor([1, 1])</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[0.1,0.2,0.5],</span></span><br><span class="line"><span class="string">[0.3,0.4,0.1]         è¾“å‡ºtensor([2, 1])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[0.1,0.2],</span></span><br><span class="line"><span class="string">[0.3,0.4]             è¾“å‡ºtensor([1, 1])      </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹åˆ—ä»£ç è¡¨ç¤ºé¢„æµ‹æ­£ç¡®çš„ä¸ªæ•°</span></span><br><span class="line">preds = outputs.argmax(<span class="number">1</span>)        <span class="comment">#æµ‹è¯•å€¼</span></span><br><span class="line">targets = torch.tensor([<span class="number">0</span>,<span class="number">1</span>])    <span class="comment">#çœŸå®å€¼   </span></span><br><span class="line"><span class="built_in">print</span>(preds == targets)          <span class="comment">#è¾“å‡º tensor([False,  True])</span></span><br><span class="line"><span class="built_in">print</span>((preds == targets).<span class="built_in">sum</span>())          <span class="comment">#è¾“å‡º 1</span></span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230205222100995.png"
                      class="" title="image-20230205222100995"
                ></strong></p>
<h2 id="ciFaræ¨¡å‹"><a href="#ciFaræ¨¡å‹" class="headerlink" title="ciFaræ¨¡å‹"></a><strong>ciFaræ¨¡å‹</strong></h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Sequential, Conv2d, MaxPool2d, Flatten, Linear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ciFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.model = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">64</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">64</span>*<span class="number">4</span>*<span class="number">4</span>,<span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>,<span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•model</span></span><br><span class="line"><span class="comment"># if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line"><span class="comment">#     ciFar_test = ciFar()</span></span><br><span class="line"><span class="comment">#     input = torch.ones((64,3,32,32))</span></span><br><span class="line"><span class="comment">#     output = ciFar_test(input)</span></span><br><span class="line"><span class="comment">#     print(output.shape)</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> CrossEntropyLoss</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ciFar10_model <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">train_data = torchvision.datasets.CIFAR10(<span class="string">&quot;../data&quot;</span>,train=<span class="literal">True</span>,transform=torchvision.transforms.ToTensor(),download=<span class="literal">True</span>)</span><br><span class="line">test_data = torchvision.datasets.CIFAR10(<span class="string">&quot;../data&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor(),download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#length</span></span><br><span class="line">train_data_len = <span class="built_in">len</span>(train_data)</span><br><span class="line">test_data_len = <span class="built_in">len</span>(test_data)</span><br><span class="line"><span class="comment">#format()å°†å‚æ•°æ›¿ä»£&#123;&#125;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(train_data_len))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æµ‹è¯•æ•°æ®é›†çš„é•¿åº¦ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(test_data_len))</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨DataLoaderåŠ è½½æ•°æ®é›†</span></span><br><span class="line">train_dataLoader = DataLoader(train_data,batch_size=<span class="number">64</span>)</span><br><span class="line">test_dataLoader = DataLoader(test_data,batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºç½‘ç»œæ¨¡å‹</span></span><br><span class="line">ciFar_test = ciFar()</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸå¤±å‡½æ•°ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰</span></span><br><span class="line">loss_fn = CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¼˜åŒ–å™¨</span></span><br><span class="line">learning_rate = <span class="number">0.01</span></span><br><span class="line">optimizer = torch.optim.SGD(ciFar_test.parameters(),lr=learning_rate)     <span class="comment">#SGDéšæœºæ¢¯åº¦ä¸‹é™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®è®­ç»ƒç½‘ç»œçš„å‚æ•°</span></span><br><span class="line">total_train_step = <span class="number">0</span>   <span class="comment">#è®­ç»ƒæ¬¡æ•°</span></span><br><span class="line">total_test_step = <span class="number">0</span>   <span class="comment">#æµ‹è¯•æ¬¡æ•°</span></span><br><span class="line">epoch = <span class="number">10</span>             <span class="comment">#è®­ç»ƒè½®æ•°</span></span><br><span class="line">total_accuracy = <span class="number">0</span>      <span class="comment">#æµ‹è¯•é›†é¢„æµ‹æ­£ç¡®æ•°</span></span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;../logs&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=====ç¬¬&#123;&#125;è½®è®­ç»ƒå¼€å§‹======&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#è®­ç»ƒæ­¥éª¤å¼€å§‹</span></span><br><span class="line">    ciFar_test.train()          <span class="comment">#ä¸å†™å½±å“ä¸å¤§ï¼Œåªæœ‰æ¶‰åŠåˆ°ç›¸åº”çš„å±‚æ‰å¿…é¡»å†™</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> train_dataLoader:</span><br><span class="line">        imgs,targets = data       <span class="comment">#targetæ˜¯çœŸå®çš„åˆ†ç±»å€¼</span></span><br><span class="line">        outputs = ciFar_test(imgs)</span><br><span class="line">        loss = loss_fn(outputs,targets)      <span class="comment">#è®¡ç®—æ¨¡å‹è¾“å‡ºä¸çœŸå®åˆ†ç±»å€¼çš„è¯¯å·®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#ä¼˜åŒ–å™¨ä¼˜åŒ–æ¨¡å‹</span></span><br><span class="line">        optimizer.zero_grad()   <span class="comment">#æ¢¯åº¦æ¸…é›¶</span></span><br><span class="line">        loss.backward()         <span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">        optimizer.step()        <span class="comment">#æ¢¯åº¦ä¸‹é™</span></span><br><span class="line"></span><br><span class="line">        total_train_step = total_train_step + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> total_train_step % <span class="number">100</span> ==<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è®­ç»ƒæ¬¡æ•°ï¼š&#123;&#125;ï¼ŒLossï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(total_train_step,loss.item()))     <span class="comment">#item()è¾“å‡ºæ•°æ®æ—¶ä¸å¸¦æ•°æ®ç±»å‹</span></span><br><span class="line">            writer.add_scalar(<span class="string">&quot;train_loss&quot;</span>,loss.item(),total_train_step)         <span class="comment">#ç”¨tensorboardè¡¨ç¤ºæŸå¤±å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#æµ‹è¯•æ­¥éª¤å¼€å§‹</span></span><br><span class="line">    ciFar_test.<span class="built_in">eval</span>()              <span class="comment">#ä¸å†™å½±å“ä¸å¤§ï¼Œåªæœ‰æ¶‰åŠåˆ°ç›¸åº”çš„å±‚æ‰å¿…é¡»å†™</span></span><br><span class="line">    total_test_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> test_dataLoader:</span><br><span class="line">            imgs,targets = data</span><br><span class="line">            outputs = ciFar_test(imgs)</span><br><span class="line">            loss = loss_fn(outputs,targets)</span><br><span class="line">            total_test_loss = total_test_loss + loss.item()</span><br><span class="line">            accuracy = (outputs.argmax(<span class="number">1</span>) == targets).<span class="built_in">sum</span>()      <span class="comment">#æ¯ä¸ªæ•°æ®é¢„æµ‹æ­£ç¡®ä¸ªæ•°</span></span><br><span class="line">            total_accuracy = total_accuracy + accuracy</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬&#123;&#125;è½®çš„æ€»Lossä¸ºï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>((i+<span class="number">1</span>),total_test_loss))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬&#123;&#125;è½®çš„æ­£ç¡®ç‡ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>((i+<span class="number">1</span>),total_accuracy / test_data_len))</span><br><span class="line">    writer.add_scalar(<span class="string">&quot;test_loss&quot;</span>,total_test_loss,total_test_step)</span><br><span class="line">    writer.add_scalar(<span class="string">&quot;test_accuracy&quot;</span>,total_accuracy / test_data_len)</span><br><span class="line">    total_test_step = total_test_step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># torch.save(ciFar_test,&quot;ciFar_test_&#123;&#125;.pth&quot;.format(i))</span></span><br><span class="line">    <span class="comment"># print(&quot;å·²ä¿å­˜ç¬¬&#123;&#125;è½®è®­ç»ƒæ¨¡å‹&quot;.format(i))</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<p><strong><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/2023/02/02/PyTorch/image-20230205223516248.png"
                      class="" title="image-20230205223516248"
                ></strong></p>
<h2 id="åˆ©ç”¨GPUè®­ç»ƒ"><a href="#åˆ©ç”¨GPUè®­ç»ƒ" class="headerlink" title="åˆ©ç”¨GPUè®­ç»ƒ"></a><strong>åˆ©ç”¨GPUè®­ç»ƒ</strong></h2><h3 id="GPè®­ç»ƒ1"><a href="#GPè®­ç»ƒ1" class="headerlink" title="GPè®­ç»ƒ1"></a><strong>GPè®­ç»ƒ1</strong></h3><p><strong>å¯¹<code> æ¨¡å‹</code>ã€<code>æ•°æ®</code>ã€<code>æŸå¤±å‡½æ•°</code>è¿›è¡Œ .cuda()å¤„ç†</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> CrossEntropyLoss</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> torch.utils.tensorboard <span class="keyword">import</span> SummaryWriter</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Sequential, Conv2d, MaxPool2d, Flatten, Linear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">train_data = torchvision.datasets.CIFAR10(<span class="string">&quot;../data&quot;</span>,train=<span class="literal">True</span>,transform=torchvision.transforms.ToTensor(),download=<span class="literal">True</span>)</span><br><span class="line">test_data = torchvision.datasets.CIFAR10(<span class="string">&quot;../data&quot;</span>,train=<span class="literal">False</span>,transform=torchvision.transforms.ToTensor(),download=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#length</span></span><br><span class="line">train_data_len = <span class="built_in">len</span>(train_data)</span><br><span class="line">test_data_len = <span class="built_in">len</span>(test_data)</span><br><span class="line"><span class="comment">#format()å°†å‚æ•°æ›¿ä»£&#123;&#125;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(train_data_len))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æµ‹è¯•æ•°æ®é›†çš„é•¿åº¦ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(test_data_len))</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨DataLoaderåŠ è½½æ•°æ®é›†</span></span><br><span class="line">train_dataLoader = DataLoader(train_data,batch_size=<span class="number">64</span>)</span><br><span class="line">test_dataLoader = DataLoader(test_data,batch_size=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºç½‘ç»œæ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ciFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.model = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">64</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">64</span>*<span class="number">4</span>*<span class="number">4</span>,<span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>,<span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">ciFar_test = ciFar()</span><br><span class="line"><span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">    ciFar_test.cuda()                        <span class="comment">#åˆ©ç”¨GPUè®­ç»ƒï¼Œä½†ä¸‹è½½çš„pytorchæ²¡æœ‰CUDï¼Œæ‰€ä»¥æ— æ³•éªŒè¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸå¤±å‡½æ•°ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰</span></span><br><span class="line">loss_fn = CrossEntropyLoss()</span><br><span class="line"><span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">    loss_fn = loss_fn.cuda()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¼˜åŒ–å™¨</span></span><br><span class="line">learning_rate = <span class="number">0.01</span></span><br><span class="line">optimizer = torch.optim.SGD(ciFar_test.parameters(),lr=learning_rate)     <span class="comment">#SGDéšæœºæ¢¯åº¦ä¸‹é™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®è®­ç»ƒç½‘ç»œçš„å‚æ•°</span></span><br><span class="line">total_train_step = <span class="number">0</span>   <span class="comment">#è®­ç»ƒæ¬¡æ•°</span></span><br><span class="line">total_test_step = <span class="number">0</span>   <span class="comment">#æµ‹è¯•æ¬¡æ•°</span></span><br><span class="line">epoch = <span class="number">10</span>             <span class="comment">#è®­ç»ƒè½®æ•°</span></span><br><span class="line">total_accuracy = <span class="number">0</span>      <span class="comment">#æµ‹è¯•é›†é¢„æµ‹æ­£ç¡®æ•°</span></span><br><span class="line"></span><br><span class="line">writer = SummaryWriter(<span class="string">&quot;../logs&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=====ç¬¬&#123;&#125;è½®è®­ç»ƒå¼€å§‹======&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#è®­ç»ƒæ­¥éª¤å¼€å§‹</span></span><br><span class="line">    ciFar_test.train()          <span class="comment">#ä¸å†™å½±å“ä¸å¤§ï¼Œåªæœ‰æ¶‰åŠåˆ°ç›¸åº”çš„å±‚æ‰å¿…é¡»å†™</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> train_dataLoader:</span><br><span class="line">        imgs,targets = data       <span class="comment">#targetæ˜¯çœŸå®çš„åˆ†ç±»å€¼</span></span><br><span class="line">        <span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">            imgs = imgs.cuda()</span><br><span class="line">            targets = targets.cuda()</span><br><span class="line">        outputs = ciFar_test(imgs)</span><br><span class="line">        loss = loss_fn(outputs,targets)      <span class="comment">#è®¡ç®—æ¨¡å‹è¾“å‡ºä¸çœŸå®åˆ†ç±»å€¼çš„è¯¯å·®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#ä¼˜åŒ–å™¨ä¼˜åŒ–æ¨¡å‹</span></span><br><span class="line">        optimizer.zero_grad()   <span class="comment">#æ¢¯åº¦æ¸…é›¶</span></span><br><span class="line">        loss.backward()         <span class="comment">#åå‘ä¼ æ’­</span></span><br><span class="line">        optimizer.step()        <span class="comment">#æ¢¯åº¦ä¸‹é™</span></span><br><span class="line"></span><br><span class="line">        total_train_step = total_train_step + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> total_train_step % <span class="number">100</span> ==<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è®­ç»ƒæ¬¡æ•°ï¼š&#123;&#125;ï¼ŒLossï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(total_train_step,loss.item()))     <span class="comment">#item()è¾“å‡ºæ•°æ®æ—¶ä¸å¸¦æ•°æ®ç±»å‹</span></span><br><span class="line">            writer.add_scalar(<span class="string">&quot;train_loss&quot;</span>,loss.item(),total_train_step)         <span class="comment">#ç”¨tensorboardè¡¨ç¤ºæŸå¤±å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#æµ‹è¯•æ­¥éª¤å¼€å§‹</span></span><br><span class="line">    ciFar_test.<span class="built_in">eval</span>()              <span class="comment">#ä¸å†™å½±å“ä¸å¤§ï¼Œåªæœ‰æ¶‰åŠåˆ°ç›¸åº”çš„å±‚æ‰å¿…é¡»å†™</span></span><br><span class="line">    total_test_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> test_dataLoader:</span><br><span class="line">            imgs,targets = data</span><br><span class="line">            <span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">                imgs = imgs.cuda()</span><br><span class="line">                targets = targets.cuda()</span><br><span class="line">            outputs = ciFar_test(imgs)</span><br><span class="line">            loss = loss_fn(outputs,targets)</span><br><span class="line">            total_test_loss = total_test_loss + loss.item()</span><br><span class="line">            accuracy = (outputs.argmax(<span class="number">1</span>) == targets).<span class="built_in">sum</span>()      <span class="comment">#æ¯ä¸ªæ•°æ®é¢„æµ‹æ­£ç¡®ä¸ªæ•°</span></span><br><span class="line">            total_accuracy = total_accuracy + accuracy</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬&#123;&#125;è½®çš„æ€»Lossä¸ºï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>((i+<span class="number">1</span>),total_test_loss))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬&#123;&#125;è½®çš„æ­£ç¡®ç‡ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>((i+<span class="number">1</span>),total_accuracy / test_data_len))</span><br><span class="line">    writer.add_scalar(<span class="string">&quot;test_loss&quot;</span>,total_test_loss,total_test_step)</span><br><span class="line">    writer.add_scalar(<span class="string">&quot;test_accuracy&quot;</span>,total_accuracy / test_data_len)</span><br><span class="line">    total_test_step = total_test_step + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># torch.save(ciFar_test,&quot;ciFar_test_&#123;&#125;.pth&quot;.format(i))</span></span><br><span class="line">    <span class="comment"># print(&quot;å·²ä¿å­˜ç¬¬&#123;&#125;è½®è®­ç»ƒæ¨¡å‹&quot;.format(i))</span></span><br><span class="line"></span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure></div>

<h3 id="GPUè®­ç»ƒ2ï¼ˆå¸¸ç”¨ï¼‰"><a href="#GPUè®­ç»ƒ2ï¼ˆå¸¸ç”¨ï¼‰" class="headerlink" title="GPUè®­ç»ƒ2ï¼ˆå¸¸ç”¨ï¼‰"></a><strong>GPUè®­ç»ƒ2ï¼ˆå¸¸ç”¨ï¼‰</strong></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<h1 id="æ¨¡å‹éªŒè¯"><a href="#æ¨¡å‹éªŒè¯" class="headerlink" title="æ¨¡å‹éªŒè¯"></a><strong>æ¨¡å‹éªŒè¯</strong></h1><p><strong>æ³¨æ„ï¼špngæ ¼å¼æ˜¯4é€šé“ï¼Œé™¤äº†RGB3ä¸ªé€šé“ï¼Œè¿˜æœ‰ä¸€ä¸ªé€æ˜é€šé“ã€‚è°ƒç”¨<code>image.convert(&#39;RGB&#39;)</code>ï¼Œä¿ç•™å…¶é¢œè‰²é€šé“ï¼Œå³3é€šé“</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> Sequential, Conv2d, MaxPool2d, Flatten, Linear</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ciFar</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.model = Sequential(</span><br><span class="line">            Conv2d(<span class="number">3</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Conv2d(<span class="number">32</span>,<span class="number">64</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">            MaxPool2d(<span class="number">2</span>),</span><br><span class="line">            Flatten(),</span><br><span class="line">            Linear(<span class="number">64</span>*<span class="number">4</span>*<span class="number">4</span>,<span class="number">64</span>),</span><br><span class="line">            Linear(<span class="number">64</span>,<span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.model(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">img_path = <span class="string">&quot;../dataset/plane1.png&quot;</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(img_path)</span><br><span class="line">img = img.convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(img)</span><br><span class="line"></span><br><span class="line">transforms = torchvision.transforms.Compose([</span><br><span class="line">    torchvision.transforms.Resize((<span class="number">32</span>,<span class="number">32</span>)),</span><br><span class="line">    torchvision.transforms.ToTensor()</span><br><span class="line">])</span><br><span class="line">image = transforms(img)</span><br><span class="line"><span class="comment"># print(image.shape)</span></span><br><span class="line">image = torch.reshape(image,(<span class="number">1</span>,<span class="number">3</span>,<span class="number">32</span>,<span class="number">32</span>))         <span class="comment">#1æ˜¯batch_size   é€šå¸¸éƒ½éœ€è¦æŒ‡å®š</span></span><br><span class="line"></span><br><span class="line">model = torch.load(<span class="string">&quot;ciFar_test_29.pth&quot;</span>,map_location=torch.device(<span class="string">&#x27;cpu&#x27;</span>))   <span class="comment">#ç»CUDAè®­ç»ƒçš„æ¨¡å‹è¦æƒ³åœ¨CPUä¸Šè¿è¡Œï¼Œéœ€è®¾ç½®map_location</span></span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æµ‹è¯•å¼€å§‹</span></span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    output = model(image)</span><br><span class="line"><span class="built_in">print</span>(output.argmax(<span class="number">1</span>))</span><br></pre></td></tr></table></figure></div>


            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>æ ‡é¢˜:</strong> PyTorch</li>
        <li><strong>ä½œè€…:</strong> Airex Yu</li>
        <li><strong>åˆ›å»ºäº:</strong> 2023-02-02 12:32:18</li>
        
            <li>
                <strong>æ›´æ–°äº:</strong> 2023-05-25 21:11:31
            </li>
        
        <li>
            <strong>é“¾æ¥:</strong> http://example.com/2023/02/02/PyTorch/
        </li>
        <li>
            <strong>ç‰ˆæƒå£°æ˜:</strong> æœ¬æ–‡ç« é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> è¿›è¡Œè®¸å¯ã€‚
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/PyTorch/">#PyTorch</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/TensorBoard/">#TensorBoard</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/VGG/">#VGG</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/">#æ¨¡å‹è®­ç»ƒ</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/%E4%BC%98%E5%8C%96%E5%99%A8/">#ä¼˜åŒ–å™¨</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/">#æ¿€æ´»å‡½æ•°</a>&nbsp;
                        </li>
                    
                </ul>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/02/06/opencv/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">opencv</span>
                                    <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/01/31/Numpy/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">Numpy</span>
                                    <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;è¯„è®º
    </div>
    

        
            
 
    <div id="waline"></div>
    <script type="module"  data-pjax>
        import { init } from 'https://evan.beee.top/js/waline.mjs';

        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://example.example.com',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
            });
        }

        if ('true') {
            const loadWalineTimeout = setTimeout(() => {
                loadWaline();
                clearTimeout(loadWalineTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadWaline);
        }
        
    </script>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">æ­¤é¡µç›®å½•</div>
        <div class="page-title">PyTorch</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PyTorch"><span class="nav-text">PyTorch</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PyTorch%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-text">PyTorchçš„å®‰è£…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PyTorch%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-text">PyTorchç›¸å…³å‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PyTorch%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="nav-text">PyTorchåŠ è½½æ•°æ®</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tensorboard"><span class="nav-text">Tensorboard</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%98%E5%88%B6%E5%9B%BE%E5%83%8F"><span class="nav-text">ç»˜åˆ¶å›¾åƒ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87"><span class="nav-text">æ·»åŠ å›¾ç‰‡</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#transforms"><span class="nav-text">transforms</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%86PIL%E7%B1%BB%E5%9E%8B%E5%9B%BE%E5%83%8F%E8%BD%AC%E5%8C%96%E4%B8%BAtensor%E7%B1%BB%E5%9E%8B"><span class="nav-text">å°†PILç±»å‹å›¾åƒè½¬åŒ–ä¸ºtensorç±»å‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84transforms"><span class="nav-text">å¸¸è§çš„transforms</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96"><span class="nav-text">å½’ä¸€åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resize"><span class="nav-text">Resize</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#compose"><span class="nav-text">compose</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RandomCrop"><span class="nav-text">RandomCrop</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Torchvision%E4%B8%AD%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">Torchvisionä¸­æ•°æ®é›†çš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DataLoader%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">DataLoaderçš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E9%AA%A8%E6%9E%B6"><span class="nav-text">ç¥ç»ç½‘ç»œéª¨æ¶</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AF%E6%B5%8B%E8%AF%95"><span class="nav-text">å·ç§¯æµ‹è¯•</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AF%E5%B1%82"><span class="nav-text">å·ç§¯å±‚</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B1%A0%E5%8C%96%E5%B1%82"><span class="nav-text">æ± åŒ–å±‚</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%BF%80%E6%B4%BB"><span class="nav-text">éçº¿æ€§æ¿€æ´»</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E6%BF%80%E6%B4%BB"><span class="nav-text">çº¿æ€§æ¿€æ´»</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sequential%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">Sequentialçš„ä½¿ç”¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="nav-text">æŸå¤±å‡½æ•°</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E5%99%A8"><span class="nav-text">ä¼˜åŒ–å™¨</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#VGG"><span class="nav-text">VGG</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD"><span class="nav-text">æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E5%A5%97%E8%B7%AF"><span class="nav-text">å®Œæ•´çš„è®­ç»ƒæ¨¡å‹å¥—è·¯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-text">è¡¥å……</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ciFar%E6%A8%A1%E5%9E%8B"><span class="nav-text">ciFaræ¨¡å‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A9%E7%94%A8GPU%E8%AE%AD%E7%BB%83"><span class="nav-text">åˆ©ç”¨GPUè®­ç»ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GP%E8%AE%AD%E7%BB%831"><span class="nav-text">GPè®­ç»ƒ1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GPU%E8%AE%AD%E7%BB%832%EF%BC%88%E5%B8%B8%E7%94%A8%EF%BC%89"><span class="nav-text">GPUè®­ç»ƒ2ï¼ˆå¸¸ç”¨ï¼‰</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E9%AA%8C%E8%AF%81"><span class="nav-text">æ¨¡å‹éªŒè¯</span></a></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2023</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Airex Yu</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">ç”± <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨</span>
                <br>
            <span class="theme-version-container">ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.1.5</a>
        </div>
        
        
        
            <div id="start_div" style="display:none">
                2023/01/05 11:45:14
            </div>
            <div>
                åšå®¢å·²è¿è¡Œ <span class="odometer" id="runtime_days" ></span> å¤© <span class="odometer" id="runtime_hours"></span> å°æ—¶ <span class="odometer" id="runtime_minutes"></span> åˆ†é’Ÿ <span class="odometer" id="runtime_seconds"></span> ç§’
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/layouts/navbarShrink.js"></script>

<script src="/js/tools/scrollTopBottom.js"></script>

<script src="/js/tools/lightDarkSwitch.js"></script>



    
<script src="/js/tools/localSearch.js"></script>




    
<script src="/js/tools/codeBlock.js"></script>




    
<script src="/js/layouts/lazyload.js"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>





<div class="post-scripts pjax">
    
        
<script src="/js/tools/tocToggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/layouts/toc.js"></script>

<script src="/js/plugins/tabs.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>




</body>
</html>
